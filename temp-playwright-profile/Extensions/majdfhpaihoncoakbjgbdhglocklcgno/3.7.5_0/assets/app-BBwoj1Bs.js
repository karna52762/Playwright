import{b as M,i as u}from"./index-BwDjUviV.js";const o=new Map,c=new Map,d=M.runtime.connect({name:`popup_${Date.now()}`});d.onMessage.addListener(e=>{if(u(e)){const n=e.id?o.get(e.id):o.get(e.type);n&&n(e);const t=e.id?c.get(e.id):c.get(e.type);t&&t.forEach(s=>{s(e)})}});const a=function(){d.disconnect()};window.addEventListener("beforeunload",a);window.addEventListener("unload",a);function f(){return async function(n,...t){return new Promise(s=>{const i=crypto.randomUUID();o.set(i,p=>{o.delete(i),s(p)});const r={type:n,id:i,data:t[0]??{}};d.postMessage(r)})}}const g=f();export{g as s};
